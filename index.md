> "The derivative, as this notion appears in the elementary differential calculus, is a familiar mathematical example of a function for which both [the domain and the range] consist of functions. Or, turning to the integral calculus, if in the expression <img src="https://render.githubusercontent.com/render/math?math=\int^{1}_0(f x)dx"> we take the function <img src="https://render.githubusercontent.com/render/math?math=f"> as independent variable, we are led to a function for which the range of arguments consists of functions and the range of values, of numbers."
>
> - Alonzo Church (1941), [The Calculi of Lambda Conversion](/public/church/church_calculi_1941.pdf#page=9)

In ancient times, our ancestors used small pebbles to encode and
manipulate abstract quantities according to a small set of rules. In
effect, they were trading mental for mechanical labor. With the advent
of pen and paper, those same rules could be translated into written
symbols and more recently, electrical impulses and transistors.

Today we make the same trade when implementing mathematical algorithms:
one can either spend a great deal of effort manipulating an expression
with pen and paper, then implement the result as a computer program, or
we could implement the rules, then let the computer manipulate the
expression on our behalf. We call this exchange *calculus*.

Modern calculus is a topic with a variety of applications in classical
and statistical computing. Broadly, it encompasses any formal system for
manipulating symbolic expressions according to a fixed set of rules. We
are specifically interested in its applications to computer programming.
Each week, we will read a paper and hold a short discussion. All are
welcome to attend.

## Schedule

### Winter/Spring 2021

| Date              | Talk                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Presenter                                                                    |
|:------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------|
| Feb. 5, 9:30 am   | Automatic Differentiation in PyTorch <br/>-[Slides](/public/pytorch/ad_pytorch.pdf), [notebook](https://colab.research.google.com/drive/14KPZmXxa21YkFGKsVe37RV-AiT6YMRao#scrollTo=HJwyjWJn65eJ), [picograd](https://github.com/breandan/picograd/blob/main/picograd.py)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | [Breandan Considine](https://www.cs.mcgill.ca/~jguo/lab.html)                |
| Feb. 12, 1:00 pm  | Programming with Probabilities <br/>-[Recording](https://youtu.be/Hw6a8LZg6b4), [notes](/public/probprog/probprog_notes.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | [Breandan Considine](https://www.cs.mcgill.ca/~jguo/lab.html)                |
| Feb. 19, 12:00 pm | Introduction to Sequent Calculus <br/>-[Recording](https://www.youtube.com/watch?v=xLRUofFSq5Y), [notes](/public/seqcalc/seqcalc_notes.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | [Breandan Considine](https://www.cs.mcgill.ca/~jguo/lab.html)                |
| Feb. 26, 10:00 am | [Quantitative Equational Reasoning](https://www.cambridge.org/core/books/foundations-of-probabilistic-programming/quantitative-equational-reasoning/4B76BCCD4D6A3A37459C35ED2CE5FF93) <br/>-[Recording](https://www.youtube.com/watch?v=UgRIyy21Ucw), [slides](/public/panangaden/mila_rg_Feb2021.pdf), [textbook #1](http://www2.stat.duke.edu/~sayan/ambrosio.pdf), [textbook #2](https://www.springer.com/gp/book/9783319208275)<br/><details>We develop a quantitative analogue of equational reasoning which we call quantitative algebra. We define an equality relation indexed by rationals: a =<sub>ε</sub> b which we think of as saying that “a is approximately equal to b up to an error of ε”. We have 4 interesting examples where we have a quantitative equational theory whose free algebras correspond to well known structures. The most interesting example comes from the case of the Kantorovich metric. I will present this as a tutorial on equational reasoning.</details>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | [Prakash Panangaden](https://www.cs.mcgill.ca/~prakash/)                     |
| Mar. 1 - Mar. 5   | [Study Break](https://www.mcgill.ca/importantdates/channels/event/winter-2021-study-break-302330) / [Période d'activités libres](https://registraire.umontreal.ca/dates-importantes/calendriers-universitaires/)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | N/A                                                                          |
| Mar. 12, 11:00 am | [Drasil: Generate all the Things!](https://github.com/JacquesCarette/Drasil) <br/>-[Recording](https://www.youtube.com/watch?v=q8l6TpXfJks), [slides](/public/drasil/IntroToDrasil.pdf)<br/><details>Generative techniques are useful for more than just code generation: many of the artifacts that make up 'software' can be generated too. The question then becomes, which ones, what is an adequate 'source' language for describing them, and when is such an approach effective. This talk will meander through these questions, giving answers that have emerged from our work on the Drasil system. While far from a silver bullet, an interesting subset of software does emerge that can be effectively attacked in this way.</details>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | [Jacques Carette](https://www.cas.mcmaster.ca/~carette/)                     |
| Mar. 19, 9:30 am  | [Automatic Reparameterisation of Probabilistic Programs](https://arxiv.org/pdf/1906.03028.pdf)<br/>-[Recording](https://www.youtube.com/watch?v=B6yBChnW3nE), [slides](/public/gorinova/autoreparam.pdf), [Stan tutorial](https://mc-stan.org/users/documentation/case-studies/divergences_and_bias.html)<br/><details>Markov chain Monte Carlo (MCMC) algorithms can be used to approximate a probability distribution by continuously sampling from it. Some MCMC strategies, such as Hamiltonian Monte Carlo (HMC), use the gradient of the unnormalised density function to increase the quality of the obtained samples and the speed of convergence of the algorithm. But such algorithms can fail, and often silently, if the curvature of this target density function varies. One way to work around this problem is to reparameterise the distribution of interest, meaning to express it in terms of different parameters.<br/>In this talk, I will describe the practical challenges of finding a suitable reparameterisation, and demonstrate how we can use mechanisms available in recent probabilistic programming languages to implement a family of parameterisations often used in practice. In particular, we will look at a continuous relaxation of the question of what parameterisation to use and combine it with variational inference to obtain robust and efficient MCMC samplers.</details>                                                                                                                                                                                                                 | [Maria Gorinova](http://homepages.inf.ed.ac.uk/s1207807/)                    |
| Mar. 26, 12:00 pm | Inside Every Calculus Is A Little Algebra Waiting To Get Out<br/>-[Recording](https://www.youtube.com/watch?v=oGugoP96vzE), [textbook #1](https://users-math.au.dk/kock/sdg99.pdf#page=3), [textbook #2](https://doi.org/10.1017/CBO9780511619625)<details>Because of deep learning, there has been a surge in interest in automatic differentiation, especially from the functional programming community. As a result there are many recent papers that look at AD from a Category Theory perspective. However, Category Theorists have already been looking at differentiation and calculus in general since the late 60’s in the context of Synthetic Differential Geometry, but it seems that this work is largely ignored by those interested in AD. In this talk, we will provide a gentle introduction to the ideas of SDG, by relating them to dual numbers, and show how it provides a simple and purely algebraic approach to (automatic) differentiation.</details>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | [Erik Meijer](https://scholar.google.ca/citations?user=odFMpOYAAAAJ)         |
| Apr. 1, 9:30 am   | [Tensor Networks, Probabilistic Modeling, and Formal Grammar](https://arxiv.org/pdf/2003.01039.pdf)<br/>-[Recording](https://www.youtube.com/watch?v=y_7s-G4zIXw), [slides](/public/miller/tensor_networks.pdf), [FGs](http://people.binf.ku.dk/~thamelry/MLSB08/hal.pdf), [Codes on graphs](https://ieeexplore.ieee.org/document/910573) (thanks to Tristan) <br/><details>Tensor networks (TNs) are a general formalism for efficiently modeling complex higher-order tensors, whose broad applications within quantum many-body physics have led them to be described as the natural framework for modeling quantum states of matter. Spurred on by their independent rediscovery in applied mathematics, TNs have increasingly been used for machine learning, where they have unlocked a growing number of novel theoretical and practical results. In this talk, we discuss one such result, concerning the use of TN models for modeling probabilistic sequence data. We show how a simple recurrent TN model enables a novel algorithm for conditional sampling from collections of strings defined by formal grammars, a significant generalization of the autoregressive sampling of typical language models. By developing this unexpected link between quantum physics and language, we expect our results to contribute to the search for mathematically principled methods for unsupervised grammatical inference in NLP.</details>                                                                                                                                                                                        | [Jacob Miller](https://jemisjoky.com/)                                       |
| Apr. 9, 10:00 am  | [Computing derivatives of matrix and tensor expressions](https://papers.nips.cc/paper/2018/file/0a1bf96b7165e962e90cb14648c9462d-Paper.pdf)<br/>-[Recording](https://www.youtube.com/watch?v=IbTRRlPZwgc), [slides](/public/laue/tensor_derivatives.pdf)<details>Expressions involving matrix and tensors are often encountered in the area of machine learning. For such expressions, it is often necessary to obtain first and second-order derivatives. In my talk, I will present two algorithmic approaches for computing such matrix and tensor derivatives. Both approaches can be used for symbolic as well as for forward and reverse mode algorithmic differentiation. Experiments show a speedup between two and three orders of magnitude over state-of-the-art frameworks like TensorFlow or PyTorch when evaluating higher-order derivatives.<br/>An online interface to our approach can be found at [http://www.MatrixCalculus.org](http://www.MatrixCalculus.org).</details>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | [Sören Laue](https://theinf2.informatik.uni-jena.de/People/Soeren+Laue.html) |
| Apr. 16, 3:00 pm  | [Harnessing second order optimizers from deep learning frameworks](https://blog.twitter.com/engineering/en_us/topics/insights/2021/harnessing-second-order-optimizers-from-deep-learning-frameworks.html)<br/>-[Recording](https://www.youtube.com/watch?v=a4T1IlKxPy0), [slides](/public/turner/dict-minimize.pdf), [GitHub](https://github.com/twitter/dict_minimize), [PyPI](https://pypi.org/project/dict-minimize/), [Read the Docs](https://dict-minimize.readthedocs.io/en/latest/)<br/><details>Have you ever wanted to use a second order optimizer on code written in TensorFlow or PyTorch? What about optimizing a dictionary of tensors using SciPy minimize? If so, a lot of troublesome glue code was probably needed. For another way, look no further than the dict-minimize package, which takes care of everything and lets users easily optimize objectives implemented in TensorFlow, PyTorch, or JAX.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | [Ryan Turner](https://sites.google.com/site/wwwturnercomputingcom/)          |
| Apr. 22, 1:30 pm  | [Factor Graph Grammars for Probabilistic Modeling](https://proceedings.neurips.cc/paper/2020/file/49ca03822497d26a3943d5084ed59130-Paper.pdf)<br/>-[Recording](https://www.youtube.com/watch?v=8xhTESwcpkw), [slides](/public/riley/fggs.pdf) / [HRG survey](https://people.cs.umu.se/drewes/biblio/ps-files/hrg.pdf), [Graph](https://www.aclweb.org/anthology/P13-1091.pdf) & [AMR parsing](https://www.cs.rochester.edu/u/gildea/pubs/peng-conll15.pdf), [MT](https://www.cs.rochester.edu/u/gildea/pubs/peng-conll15.pdf)<br/><details>Probabilistic graphical models (PGMs) are a powerful method for specifying probability distributions. However, they are unable to represent some of the most popular models used in NLP, such as HMMs and PCFGs (since PGMs assume a fixed number of random variables, while HMMs and PCFGs can generate sentences of arbitrary length). In this talk, I will present factor graph grammars (FGGs), an extension of PGMs that is able to capture these models and many others. A FGG is a type of grammar, called a hyperedge replacement graph grammar, which generates a (possibly infinite) set of factor graphs. Conveniently, inference can be done over the FGG without enumerating all the factor graphs in the set. For finite variable domains (but possibly infinite sets of graphs), a generalization of variable elimination to FGGs allows exact and tractable inference in many situations. This talk will introduce the FGG formalism and present that inference algorithm.</details>                                                                                          | [Darcey Riley](https://darcey.github.io/)                                    |
| Apr. 30, 1:00 pm  | [Gradual tensor typing for practical machine learning in Haskell with Hasktorch](https://github.com/hasktorch/hasktorch)<br/><details>Hasktorch is a library for neural networks and tensor math in Haskell. It is leveraging the C++ backend of PyTorch for fast numerical computation with GPU support. Hasktorch’s goal is to provide a platform for machine learning using typed functional programming. Gradually typed Hasktorch is a new API for tensors and neural networks that interpolates between the already existing unchecked (that is, untyped) and checked (typed) Hasktorch APIs. Thus far, users have to choose whether they want to commit fully to either typed or untyped tensors and models. The new gradually typed API relaxes this black-and-white tradeoff and makes the decision more granular. In gradually typed Hasktorch, users can choose whether or not they want type checking for every individual type variable, like a tensor’s compute device (e.g. the CPU or a GPU), its precision (Bool, Int64, Float, etc.), or its shape (the names and sizes of its dimensions). Thus, users can enjoy the flexibility of an unchecked API for rapid prototyping, while they can also add as much type checking as they want later on. Alternatively, users can start with fully checked tensor and model types and relax them when and where they get in the way. Thus, gradually typed Hasktorch combines the best of both worlds, of checked and of unchecked Hasktorch. The talk will use simple examples to demonstrate the benefits of gradual typing for tensor math and machine learning.</details> | [Torsten Scholak](https://tscholak.github.io/)                               |

If you would like to sign up to present or wish to receive updates from
the mailing list, please reach out to the organizer via the following
address: `breandan dot considine at mail dot mcgill dot ca`.

## Reading Materials

A few recent papers on differential, integral and logical calculi are listed for illustrative purposes below, following the general theme of topics we plan to discuss. Other suggested reading materials are also welcome!

### Differential

Differentiable programming concerns the calculus of infinitesimal change and change propagation through a computation graph. This subject is the original and primary focus of this reading group.

* [Learners' languages](https://arxiv.org/abs/2103.01189), Spivak (2021)
* [CHAD: Combinatory Homomorphic Automatic Differentiation](https://arxiv.org/pdf/2103.15776.pdf), Vakar (2021)
* [Symbolic and Automatic Differentiation of Languages](http://conal.net/papers/language-derivatives/paper.pdf), Elliott (2021)
* [Swift for TensorFlow: A portable, flexible platform for deep learning](https://arxiv.org/pdf/2102.13243.pdf), Saeta et al. (2021)
* [∂ is for Dialectica: Typing Differentiable Programming](https://hal.archives-ouvertes.fr/hal-03123968/document), Kerjean and Pédrot (2021)
* [λ<sub>S</sub>: Computable semantics for differentiable programming](https://arxiv.org/pdf/2007.08017.pdf), Sherman et al. (2020)
* [Instead of Rewriting Foreign Code for Machine Learning, Automatically Synthesize Fast Gradients](https://arxiv.org/pdf/2010.01709.pdf), Moses and Churavy (2020)
* [Differentiable Weighted Finite-State Transducers](https://arxiv.org/pdf/2010.01003.pdf), Hannun et al. (2020)
* [A simple and efficient tensor calculus](https://ojs.aaai.org/index.php/AAAI/article/view/5881/5737), Laue et al. (2020)
* [Differentiate Everything with a Reversible Domain-Specific Language](https://arxiv.org/pdf/2003.04617.pdf), Liu and Zhao (2020)
* [Gradient Descent: The Ultimate Optimizer](https://arxiv.org/pdf/1909.13371.pdf), Chandra et al. (2019)
* [The Differentiable Curry](https://openreview.net/pdf?id=ryxuz9SzDB), Abadi et al. (2019)
* [PyTorch: An Imperative Style, High-Performance Deep Learning Library](https://papers.nips.cc/paper/2019/file/bdbca288fee7f92f2bfa9f7012727740-Paper.pdf), Paszke et al. (2019)
* [The Simple Essence of Automatic Differentiation](https://arxiv.org/pdf/1804.00746.pdf), Elliott (2018)
* [Automatic differentiation in ML: Where we are and where we should be going](https://arxiv.org/pdf/1810.11530.pdf), Merriënboer et al. (2018)
* [Automatic differentiation in machine learning: a survey](https://www.jmlr.org/papers/volume18/17-468/17-468.pdf), Baydin et al. (2017)

### Integral

We will also discuss some topics in automatic integration or probabilistic programming, i.e. the study of volume, density and how to derive their exact or approximate quantity.

* [Probabilistic Programming Semantics for Name Generation](https://dl.acm.org/doi/pdf/10.1145/3434292), Sabok et al. (2021)
* [Quantitative Equational Reasoning](https://www.cambridge.org/core/services/aop-cambridge-core/content/view/4B76BCCD4D6A3A37459C35ED2CE5FF93/9781108488518c10_333-360.pdf/quantitative_equational_reasoning.pdf), Bacci, Mardare, Panangaden, and Plotkin (2020)
* [Dice: Compiling Discrete Probabilistic Programs for Scalable Inference](https://arxiv.org/pdf/2005.09089v3.pdf), Holtzen (2020)
* [Bean Machine: A Declarative Probabilistic Programming Language For Efficient Programmable Inference](http://proceedings.mlr.press/v138/tehrani20a/tehrani20a.pdf), Tehrani et al. (2020)
* [miniKanren as a Tool for Symbolic Computation in Python](https://arxiv.org/pdf/2005.11644.pdf), Willard (2020)
* [PPL Bench: Evaluation Framework For Probabilistic Programming Languages](https://arxiv.org/pdf/2010.08886.pdf), Kulkarni et al. (2020)
* [Probabilistic Circuits: A Unifying Framework for Tractable Probabilistic Models](http://starai.cs.ucla.edu/papers/ProbCirc20.pdf), Choi et al. (2020)
* [Probabilistic Programming with CuPPL](https://arxiv.org/pdf/2010.08454.pdf), Collins and Grover (2020)
* [Symbolic Exact Inference for Discrete Probabilistic Programs](https://arxiv.org/pdf/1904.02079.pdf), Holtzen (2019)
* [Automatic Reparameterisation of Probabilistic Programs](https://arxiv.org/pdf/1906.03028.pdf), Gorinova et al. (2019)
* [A domain theory for statistical probabilistic programming](https://dl.acm.org/doi/pdf/10.1145/3290349), Vákár et al. (2019)
* [Deep Learning for Symbolic Mathematics](https://arxiv.org/pdf/1912.01412.pdf), Lample and Charton (2019)
* [Exact Bayesian inference by symbolic disintegration](https://dl.acm.org/doi/abs/10.1145/3009837.3009852), Shan and Ramsey (2017)
* [Simplifying Probabilistic Programs Using Computer Algebra](http://homes.sice.indiana.edu/ccshan/rational/simplify.pdf), Carette and Shan (2016)
* [Augur: Data-Parallel Probabilistic Modeling](https://papers.nips.cc/paper/2014/file/cf9a242b70f45317ffd281241fa66502-Paper.pdf), Tristan et al. (2014)

#### Presentations

* [Sémantiques des Calculs Distribués, Différentiels et Probabilistes](https://www.irif.fr/~tasson/doc/recherche/18_HDR_presentation.pdf), Tasson (2018)

#### Books

* [An Introduction to Probabilistic Programming](https://arxiv.org/pdf/1809.10756.pdf), Van de Meen et al. (2018)
* [Foundations of Probabilistic Programming](https://www.cambridge.org/core/services/aop-cambridge-core/content/view/819623B1B5B33836476618AC0621F0EE/9781108488518AR.pdf), Barthe et al. (2020)

### Logical

Finally, we plan to discuss some related topics in other logical calculi, including combinatory logic, sequent calculus and other formal systems. This material will be primarily introductory and no prior experience is expected or required.

* [A general definition of dependent type theories](https://arxiv.org/pdf/2009.05539.pdf), Bauer (2020)
* [Inductive Types Deconstructed: The Calculus of United Constructions](https://dl.acm.org/doi/abs/10.1145/3331554.3342607), Monnier (2019)
* [Lecture Notes on the Lambda Calculus](https://www.irif.fr/~mellies/mpri/mpri-ens/biblio/Selinger-Lambda-Calculus-Notes.pdf), Selinger (2013)
* [Binary Lambda Calculus and Combinatory Logic](https://drops.dagstuhl.de/opus/volltexte/2006/628/pdf/06051.TrompJohn.Paper.628.pdf), Tromp (2006)
* [The differential lambda-calculus](https://core.ac.uk/download/pdf/82396223.pdf), Ehrhard and Regnier (2001)
* [The SKI Combinator Calculus, a universal formal system](http://people.cs.uchicago.edu/~odonnell/Teacher/Lectures/Formal_Organization_of_Knowledge/Examples/combinator_calculus.texpdf.pdf), O'Donnell
* [Constructive Mathematics and Computer Programming](https://www.cs.tufts.edu/~nr/cs257/archive/per-martin-lof/constructive-math.pdf), Per Martin-Löf (1976)
* [On the building blocks of mathematical logic](https://writings.stephenwolfram.com/data/uploads/2020/12/Schonfinkel-OnTheBuildingBlocksOfMathematicalLogic.pdf), Schönfinkel (1924)